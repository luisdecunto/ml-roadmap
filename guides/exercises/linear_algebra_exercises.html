<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linear Algebra Exercises - ML Roadmap</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .exercise-item {
            border-left: 4px solid #e5e7eb;
            padding-left: 1rem;
            margin-bottom: 1.5rem;
            transition: all 0.2s;
        }
        .exercise-item.completed {
            border-left-color: #10b981;
            opacity: 0.7;
        }
        .exercise-item h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.5rem;
        }
        .exercise-item.completed h3 {
            text-decoration: line-through;
            color: #9ca3af;
        }
        .section-header {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
            margin-top: 2rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #10b981;
            padding-bottom: 0.5rem;
        }
        .content-text {
            color: #4b5563;
            line-height: 1.6;
            margin-bottom: 0.75rem;
        }
        .content-text.completed {
            color: #9ca3af;
        }
        pre {
            background-color: #1f2937;
            color: #f3f4f6;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin: 1rem 0;
        }
        code {
            font-family: 'Courier New', monospace;
        }
        .checkbox-custom {
            width: 1.25rem;
            height: 1.25rem;
            cursor: pointer;
            accent-color: #10b981;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-emerald-50 via-teal-50 to-green-50 min-h-screen">
    <div class="max-w-5xl mx-auto p-4 md:p-8">
        <!-- Header -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
                <h1 class="text-3xl font-bold text-gray-800">Linear Algebra Exercises</h1>
                <div class="flex space-x-2">
                    <a href="../solutions/linear_algebra_solutions.html" class="px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg text-sm font-semibold">
                        View Solutions
                    </a>
                    <a href="../../index.html" class="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-sm font-semibold">
                        ‚Üê Back to Roadmap
                    </a>
                </div>
            </div>
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4 text-sm text-gray-600">
                    <span>‚è±Ô∏è Time: 3-4 hours</span>
                    <span>üìä Difficulty: Beginner-Intermediate</span>
                </div>
                <div class="text-right">
                    <div id="sync-status" class="text-xs text-gray-500 mb-1"></div>
                    <div class="text-sm text-gray-600 mb-1">Progress: <span id="progress-text" class="font-bold text-emerald-600">0%</span></div>
                    <div class="w-48 bg-gray-200 rounded-full h-2">
                        <div id="progress-bar" class="bg-emerald-600 h-2 rounded-full transition-all" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Content -->
        <div class="bg-white rounded-lg shadow-lg p-8">
            <div class="mb-6 p-4 bg-blue-50 border-l-4 border-blue-500 rounded">
                <p class="text-sm text-gray-700">
                    <strong>Instructions:</strong> Complete these exercises by hand first, then verify with NumPy.
                    Check off each exercise as you complete it to track your progress.
                </p>
            </div>

            <h2 class="section-header">Part 1: Vectors and Vector Spaces (30 min)</h2>

            <div class="exercise-item" data-exercise-id="linear-algebra-1.1">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-1.1')">
                    <div class="flex-1">
                        <h3>Exercise 1.1: Vector Operations</h3>
                        <div class="content-text">
                            Given vectors:
                            <ul class="list-disc ml-6 my-2">
                                <li><strong>a</strong> = [2, 3, -1]</li>
                                <li><strong>b</strong> = [1, -2, 4]</li>
                                <li><strong>c</strong> = [-3, 0, 2]</li>
                            </ul>
                            Calculate by hand:
                            <ol class="list-decimal ml-6 my-2">
                                <li><strong>a</strong> + <strong>b</strong></li>
                                <li>2<strong>a</strong> - 3<strong>b</strong></li>
                                <li><strong>a</strong> ¬∑ <strong>b</strong> (dot product)</li>
                                <li>||<strong>a</strong>|| (L2 norm/magnitude)</li>
                                <li>||<strong>b</strong>||‚ÇÅ (L1 norm)</li>
                            </ol>
                        </div>
                    </div>
                </label>
            </div>

            <div class="exercise-item" data-exercise-id="linear-algebra-1.2">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-1.2')">
                    <div class="flex-1">
                        <h3>Exercise 1.2: Linear Combinations</h3>
                        <div class="content-text">
                            Can you express <strong>c</strong> = [-3, 0, 2] as a linear combination of <strong>a</strong> and <strong>b</strong>?<br>
                            Find scalars Œ± and Œ≤ such that: <strong>c</strong> = Œ±<strong>a</strong> + Œ≤<strong>b</strong><br>
                            Show your work.
                        </div>
                    </div>
                </label>
            </div>

            <div class="exercise-item" data-exercise-id="linear-algebra-1.3">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-1.3')">
                    <div class="flex-1">
                        <h3>Exercise 1.3: Unit Vectors</h3>
                        <div class="content-text">
                            <ol class="list-decimal ml-6">
                                <li>Calculate the unit vector in the direction of <strong>a</strong> = [3, 4]</li>
                                <li>Verify that its magnitude is 1</li>
                            </ol>
                        </div>
                    </div>
                </label>
            </div>

            <div class="exercise-item" data-exercise-id="linear-algebra-1.4">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-1.4')">
                    <div class="flex-1">
                        <h3>Exercise 1.4: Orthogonality</h3>
                        <div class="content-text">
                            Given vectors <strong>u</strong> = [1, 2, -1] and <strong>v</strong> = [2, -1, 0]:
                            <ol class="list-decimal ml-6 my-2">
                                <li>Calculate <strong>u</strong> ¬∑ <strong>v</strong></li>
                                <li>Are these vectors orthogonal? Why or why not?</li>
                                <li>If not, find a vector <strong>w</strong> that is orthogonal to <strong>u</strong></li>
                            </ol>
                        </div>
                    </div>
                </label>
            </div>

            <h2 class="section-header">Part 2: Matrix Operations (45 min)</h2>

            <div class="exercise-item" data-exercise-id="linear-algebra-2.1">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-2.1')">
                    <div class="flex-1">
                        <h3>Exercise 2.1: Matrix Addition and Scalar Multiplication</h3>
                        <div class="content-text">
                            Given matrices:<br>
                            A = [[2, -1, 3], [0, 4, -2]]<br>
                            B = [[1, 2, -1], [3, -1, 0]]<br><br>
                            Calculate by hand:
                            <ol class="list-decimal ml-6">
                                <li>A + B</li>
                                <li>3A - 2B</li>
                            </ol>
                        </div>
                    </div>
                </label>
            </div>

            <div class="exercise-item" data-exercise-id="linear-algebra-2.2">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-2.2')">
                    <div class="flex-1">
                        <h3>Exercise 2.2: Matrix Multiplication</h3>
                        <div class="content-text">
                            Given:<br>
                            A = [[1, 2, 3], [4, 5, 6]]<br>
                            B = [[2, 1], [0, -1], [3, 2]]<br><br>
                            Calculate by hand:
                            <ol class="list-decimal ml-6">
                                <li>AB (show work for each element)</li>
                                <li>What is the dimension of AB?</li>
                                <li>Can you compute BA? Why or why not?</li>
                            </ol>
                        </div>
                    </div>
                </label>
            </div>

            <div class="exercise-item" data-exercise-id="linear-algebra-2.3">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-2.3')">
                    <div class="flex-1">
                        <h3>Exercise 2.3: Matrix-Vector Multiplication</h3>
                        <div class="content-text">
                            Given:<br>
                            A = [[2, -1, 3], [1, 0, -2], [0, 4, 1]]<br>
                            x = [[1], [2], [-1]]<br><br>
                            Calculate Ax by hand.
                        </div>
                    </div>
                </label>
            </div>

            <div class="exercise-item" data-exercise-id="linear-algebra-2.4">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-2.4')">
                    <div class="flex-1">
                        <h3>Exercise 2.4: Transpose</h3>
                        <div class="content-text">
                            Given A = [[1, 2, 3], [4, 5, 6]]:
                            <ol class="list-decimal ml-6">
                                <li>Calculate A·µÄ</li>
                                <li>Calculate (A·µÄ)·µÄ</li>
                                <li>Verify that (AB)·µÄ = B·µÄA·µÄ using matrices from Exercise 2.2</li>
                            </ol>
                        </div>
                    </div>
                </label>
            </div>

            <div class="exercise-item" data-exercise-id="linear-algebra-2.5">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-2.5')">
                    <div class="flex-1">
                        <h3>Exercise 2.5: Identity and Inverse</h3>
                        <div class="content-text">
                            <ol class="list-decimal ml-6">
                                <li>Write the 3√ó3 identity matrix I‚ÇÉ</li>
                                <li>Verify that AI = A for any 3√ó3 matrix A (use an example)</li>
                                <li>Given A = [[2, 1], [1, 1]], find A‚Åª¬π by solving AA‚Åª¬π = I</li>
                            </ol>
                        </div>
                    </div>
                </label>
            </div>

            <h2 class="section-header">Part 3: Eigenvalues and Eigenvectors (60 min)</h2>

            <div class="exercise-item" data-exercise-id="linear-algebra-3.1">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-3.1')">
                    <div class="flex-1">
                        <h3>Exercise 3.1: Understanding Eigenvectors</h3>
                        <div class="content-text">
                            Given matrix A = [[3, 1], [0, 2]] and vector <strong>v</strong> = [[1], [0]]:
                            <ol class="list-decimal ml-6">
                                <li>Calculate A<strong>v</strong></li>
                                <li>Is <strong>v</strong> an eigenvector of A? If so, what is its eigenvalue?</li>
                                <li>Try <strong>w</strong> = [[1], [1]]. Is it an eigenvector?</li>
                            </ol>
                        </div>
                    </div>
                </label>
            </div>

            <div class="exercise-item" data-exercise-id="linear-algebra-3.2">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-3.2')">
                    <div class="flex-1">
                        <h3>Exercise 3.2: Finding Eigenvalues</h3>
                        <div class="content-text">
                            Find the eigenvalues of A = [[4, 2], [1, 3]]:<br><br>
                            Steps:
                            <ol class="list-decimal ml-6">
                                <li>Set up characteristic equation: det(A - ŒªI) = 0</li>
                                <li>Solve for Œª</li>
                                <li>Show all your work</li>
                            </ol>
                        </div>
                    </div>
                </label>
            </div>

            <div class="exercise-item" data-exercise-id="linear-algebra-3.3">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-3.3')">
                    <div class="flex-1">
                        <h3>Exercise 3.3: Finding Eigenvectors</h3>
                        <div class="content-text">
                            For the matrix A and eigenvalues from Exercise 3.2:
                            <ol class="list-decimal ml-6">
                                <li>For each eigenvalue Œª, solve (A - ŒªI)<strong>v</strong> = <strong>0</strong></li>
                                <li>Find the corresponding eigenvectors</li>
                            </ol>
                        </div>
                    </div>
                </label>
            </div>

            <div class="exercise-item" data-exercise-id="linear-algebra-3.4">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-3.4')">
                    <div class="flex-1">
                        <h3>Exercise 3.4: Diagonalization</h3>
                        <div class="content-text">
                            Given A = [[3, 1], [0, 2]]:
                            <ol class="list-decimal ml-6">
                                <li>Find eigenvalues</li>
                                <li>Find corresponding eigenvectors</li>
                                <li>Form matrix P with eigenvectors as columns</li>
                                <li>Form diagonal matrix D with eigenvalues on diagonal</li>
                                <li>Verify that A = PDP‚Åª¬π</li>
                            </ol>
                        </div>
                    </div>
                </label>
            </div>

            <h2 class="section-header">Part 4: Singular Value Decomposition (SVD) (45 min)</h2>

            <div class="exercise-item" data-exercise-id="linear-algebra-4.1">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-4.1')">
                    <div class="flex-1">
                        <h3>Exercise 4.1: Understanding SVD Concepts</h3>
                        <div class="content-text">
                            For matrix A = [[3, 0], [4, 5]]:
                            <ol class="list-decimal ml-6">
                                <li>Calculate A·µÄA</li>
                                <li>Calculate AA·µÄ</li>
                                <li>Find eigenvalues of A·µÄA (these are œÉ¬≤·µ¢)</li>
                                <li>The singular values œÉ·µ¢ are the square roots - calculate them</li>
                            </ol>
                        </div>
                    </div>
                </label>
            </div>

            <div class="exercise-item" data-exercise-id="linear-algebra-4.2">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-4.2')">
                    <div class="flex-1">
                        <h3>Exercise 4.2: SVD Components</h3>
                        <div class="content-text">
                            Given that A has SVD: A = UŒ£V·µÄ<br><br>
                            For a 3√ó2 matrix A:
                            <ol class="list-decimal ml-6">
                                <li>What are the dimensions of U?</li>
                                <li>What are the dimensions of Œ£?</li>
                                <li>What are the dimensions of V?</li>
                                <li>What properties do U and V have? (orthogonal? orthonormal?)</li>
                            </ol>
                        </div>
                    </div>
                </label>
            </div>

            <div class="exercise-item" data-exercise-id="linear-algebra-4.3">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-4.3')">
                    <div class="flex-1">
                        <h3>Exercise 4.3: Rank and SVD</h3>
                        <div class="content-text">
                            Given singular values œÉ‚ÇÅ = 5, œÉ‚ÇÇ = 3, œÉ‚ÇÉ = 0, œÉ‚ÇÑ = 0:
                            <ol class="list-decimal ml-6">
                                <li>What is the rank of the matrix?</li>
                                <li>How many non-zero singular values determine the rank?</li>
                            </ol>
                        </div>
                    </div>
                </label>
            </div>

            <h2 class="section-header">Part 5: Practical Applications (30 min)</h2>

            <div class="exercise-item" data-exercise-id="linear-algebra-5.1">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-5.1')">
                    <div class="flex-1">
                        <h3>Exercise 5.1: Rotation Matrix</h3>
                        <div class="content-text">
                            The 2D rotation matrix for angle Œ∏ is:<br>
                            R(Œ∏) = [[cos(Œ∏), -sin(Œ∏)], [sin(Œ∏), cos(Œ∏)]]
                            <ol class="list-decimal ml-6 my-2">
                                <li>Write the rotation matrix for Œ∏ = 90¬∞ (œÄ/2 radians)</li>
                                <li>Apply it to vector [1, 0]</li>
                                <li>Apply it to vector [0, 1]</li>
                                <li>Verify that R(90¬∞) rotates vectors counterclockwise by 90¬∞</li>
                            </ol>
                        </div>
                    </div>
                </label>
            </div>

            <div class="exercise-item" data-exercise-id="linear-algebra-5.2">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-5.2')">
                    <div class="flex-1">
                        <h3>Exercise 5.2: Projection</h3>
                        <div class="content-text">
                            Given vector <strong>a</strong> = [3, 4] and <strong>b</strong> = [1, 0]:<br><br>
                            Calculate the projection of <strong>a</strong> onto <strong>b</strong> using:<br>
                            proj_b(a) = (a¬∑b / b¬∑b) * b
                            <ol class="list-decimal ml-6 my-2">
                                <li>Calculate by hand</li>
                                <li>Draw a sketch showing <strong>a</strong>, <strong>b</strong>, and proj_b(a)</li>
                            </ol>
                        </div>
                    </div>
                </label>
            </div>

            <div class="exercise-item" data-exercise-id="linear-algebra-5.3">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-5.3')">
                    <div class="flex-1">
                        <h3>Exercise 5.3: Linear System</h3>
                        <div class="content-text">
                            Solve by hand using matrix form Ax = b:<br>
                            2x + y = 5<br>
                            x - y = 1
                            <ol class="list-decimal ml-6 my-2">
                                <li>Write in matrix form</li>
                                <li>Solve using inverse matrix method: x = A‚Åª¬πb</li>
                                <li>Verify your solution</li>
                            </ol>
                        </div>
                    </div>
                </label>
            </div>

            <h2 class="section-header">Challenge Problems (Optional)</h2>

            <div class="exercise-item" data-exercise-id="linear-algebra-challenge-1">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-challenge-1')">
                    <div class="flex-1">
                        <h3>Challenge 1: Matrix Powers</h3>
                        <div class="content-text">
                            Given A = [[1, 1], [0, 1]]:
                            <ol class="list-decimal ml-6">
                                <li>Calculate A¬≤, A¬≥, A‚Å¥ by hand</li>
                                <li>Find a pattern for A‚Åø</li>
                                <li>Verify with NumPy for n=10</li>
                            </ol>
                        </div>
                    </div>
                </label>
            </div>

            <div class="exercise-item" data-exercise-id="linear-algebra-challenge-2">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-challenge-2')">
                    <div class="flex-1">
                        <h3>Challenge 2: Gram-Schmidt Process</h3>
                        <div class="content-text">
                            Given vectors: <strong>v‚ÇÅ</strong> = [1, 1, 0], <strong>v‚ÇÇ</strong> = [1, 0, 1], <strong>v‚ÇÉ</strong> = [0, 1, 1]<br><br>
                            Apply Gram-Schmidt orthogonalization by hand to create orthonormal basis {<strong>u‚ÇÅ</strong>, <strong>u‚ÇÇ</strong>, <strong>u‚ÇÉ</strong>}
                        </div>
                    </div>
                </label>
            </div>

            <div class="exercise-item" data-exercise-id="linear-algebra-challenge-3">
                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" class="checkbox-custom mt-1" onchange="toggleExercise('linear-algebra-challenge-3')">
                    <div class="flex-1">
                        <h3>Challenge 3: Image Compression with SVD</h3>
                        <div class="content-text">
                            Create a simple 4√ó4 grayscale image matrix (values 0-255):
                            <ol class="list-decimal ml-6">
                                <li>Perform SVD by hand (use calculator for arithmetic)</li>
                                <li>Reconstruct using only largest singular value</li>
                                <li>Compare with original</li>
                            </ol>
                        </div>
                    </div>
                </label>
            </div>

            <div class="mt-8 p-4 bg-gray-50 rounded-lg">
                <h3 class="font-semibold text-gray-800 mb-2">Tips for Success</h3>
                <ul class="list-disc ml-6 text-sm text-gray-700 space-y-1">
                    <li><strong>Show your work</strong> - Don't just write the answer</li>
                    <li><strong>Check dimensions</strong> - Make sure matrix operations are valid</li>
                    <li><strong>Verify with NumPy</strong> - Catch arithmetic errors</li>
                    <li><strong>Draw diagrams</strong> - Visualize vectors and transformations</li>
                    <li><strong>Ask "why"</strong> - Understand the geometry behind the algebra</li>
                </ul>
            </div>
        </div>

        <!-- Footer -->
        <div class="mt-6 text-center text-gray-600 text-sm space-x-4">
            <a href="../solutions/linear_algebra_solutions.html" class="text-emerald-600 hover:text-emerald-700 font-semibold">
                View Solutions ‚Üí
            </a>
            <span>|</span>
            <a href="../../index.html" class="text-indigo-600 hover:text-indigo-700 font-semibold">
                ‚Üê Back to ML Roadmap
            </a>
        </div>
    </div>

    <script>
        // GitHub sync configuration
        const GITHUB_USERNAME = 'luisdecunto';
        const GITHUB_REPO = 'ml-roadmap';
        const GITHUB_BRANCH = 'main';
        const PROGRESS_FILE = 'progress.json';

        let fileSha = null;
        let isEditMode = false;

        // Update sync status display
        function updateSyncStatus(status) {
            const statusElement = document.getElementById('sync-status');
            if (statusElement) {
                if (status === 'edit') {
                    statusElement.textContent = '‚úèÔ∏è Edit Mode';
                    statusElement.className = 'text-xs text-emerald-600 mb-1 font-semibold';
                } else if (status === 'view') {
                    statusElement.textContent = 'üëÅÔ∏è View Only';
                    statusElement.className = 'text-xs text-gray-500 mb-1';
                } else if (status === 'saving') {
                    statusElement.textContent = 'üíæ Saving...';
                    statusElement.className = 'text-xs text-blue-600 mb-1';
                } else if (status === 'saved') {
                    statusElement.textContent = '‚úÖ Saved';
                    statusElement.className = 'text-xs text-emerald-600 mb-1';
                    setTimeout(() => updateSyncStatus(isEditMode ? 'edit' : 'view'), 2000);
                }
            }
        }

        // Sync exercise completions from GitHub on page load
        async function syncFromGitHub() {
            try {
                const response = await fetch(`https://api.github.com/repos/${GITHUB_USERNAME}/${GITHUB_REPO}/contents/${PROGRESS_FILE}`, {
                    headers: {
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    fileSha = data.sha; // Store SHA for updates
                    const content = JSON.parse(atob(data.content));

                    if (content.exerciseCompletions) {
                        // Merge with existing localStorage (prefer GitHub data)
                        localStorage.setItem('exercise-completions', JSON.stringify(content.exerciseCompletions));
                    }
                }
            } catch (error) {
                console.log('Could not sync from GitHub, using local data:', error);
            }
        }

        // Save exercise completions to GitHub
        async function saveToGitHub() {
            const token = localStorage.getItem('githubToken');
            if (!token || !fileSha) {
                console.log('Cannot save to GitHub:', { hasToken: !!token, hasFileSha: !!fileSha });
                return;
            }

            console.log('Saving exercise progress to GitHub...');

            try {
                // Get current progress data
                const getCurrentProgress = await fetch(`https://api.github.com/repos/${GITHUB_USERNAME}/${GITHUB_REPO}/contents/${PROGRESS_FILE}`, {
                    headers: {
                        'Accept': 'application/vnd.github.v3+json',
                        'Authorization': `token ${token}`
                    }
                });

                if (getCurrentProgress.ok) {
                    const currentData = await getCurrentProgress.json();
                    const currentContent = JSON.parse(atob(currentData.content));
                    fileSha = currentData.sha; // Update SHA

                    // Update only exerciseCompletions
                    const exerciseCompletions = JSON.parse(localStorage.getItem('exercise-completions') || '{}');
                    currentContent.exerciseCompletions = exerciseCompletions;
                    currentContent.lastUpdated = new Date().toISOString();

                    // Save back to GitHub
                    const content = btoa(JSON.stringify(currentContent, null, 2));
                    const response = await fetch(`https://api.github.com/repos/${GITHUB_USERNAME}/${GITHUB_REPO}/contents/${PROGRESS_FILE}`, {
                        method: 'PUT',
                        headers: {
                            'Authorization': `token ${token}`,
                            'Accept': 'application/vnd.github.v3+json',
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            message: 'Update exercise progress',
                            content: content,
                            sha: fileSha,
                            branch: GITHUB_BRANCH
                        })
                    });

                    if (response.ok) {
                        const data = await response.json();
                        fileSha = data.content.sha;
                        console.log('‚úÖ Progress saved to GitHub successfully');
                    } else {
                        console.error('Failed to save to GitHub:', response.status, await response.text());
                    }
                } else {
                    console.error('Failed to fetch current progress:', getCurrentProgress.status);
                }
            } catch (error) {
                console.error('‚ùå Error saving to GitHub:', error);
            }
        }

        // Load completion state from localStorage
        function loadCompletionState() {
            const state = JSON.parse(localStorage.getItem('exercise-completions') || '{}');
            let completed = 0;
            let total = 0;

            document.querySelectorAll('.exercise-item').forEach(item => {
                const id = item.getAttribute('data-exercise-id');
                const checkbox = item.querySelector('input[type="checkbox"]');
                total++;

                if (state[id]) {
                    checkbox.checked = true;
                    item.classList.add('completed');
                    item.querySelectorAll('.content-text').forEach(el => el.classList.add('completed'));
                    completed++;
                }
            });

            updateProgress(completed, total);
        }

        // Toggle exercise completion
        function toggleExercise(exerciseId) {
            // Prevent changes in view-only mode
            if (!isEditMode) {
                alert('‚ö†Ô∏è View Only Mode\n\nTo save progress, you need to set up your GitHub token on the main roadmap page.');
                return;
            }

            const state = JSON.parse(localStorage.getItem('exercise-completions') || '{}');
            state[exerciseId] = !state[exerciseId];

            if (!state[exerciseId]) {
                delete state[exerciseId];
            }

            localStorage.setItem('exercise-completions', JSON.stringify(state));

            // Show saving status
            updateSyncStatus('saving');

            // Save to GitHub
            saveToGitHub().then(() => {
                updateSyncStatus('saved');
            });

            // Notify other windows/tabs about the change
            window.dispatchEvent(new StorageEvent('storage', {
                key: 'exercise-completions',
                newValue: JSON.stringify(state),
                url: window.location.href,
                storageArea: localStorage
            }));

            // Update UI
            const item = document.querySelector(`[data-exercise-id="${exerciseId}"]`);
            if (state[exerciseId]) {
                item.classList.add('completed');
                item.querySelectorAll('.content-text').forEach(el => el.classList.add('completed'));
            } else {
                item.classList.remove('completed');
                item.querySelectorAll('.content-text').forEach(el => el.classList.remove('completed'));
            }

            // Recalculate progress
            loadCompletionState();
        }

        // Update progress bar
        function updateProgress(completed, total) {
            const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;
            document.getElementById('progress-bar').style.width = percentage + '%';
            document.getElementById('progress-text').textContent = percentage + '%';
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', async () => {
            // Check if user has a token (edit mode)
            const token = localStorage.getItem('githubToken');
            isEditMode = !!token;

            console.log('üîç Debug Info:', {
                hasToken: !!token,
                tokenLength: token ? token.length : 0,
                isEditMode: isEditMode,
                allLocalStorageKeys: Object.keys(localStorage)
            });

            await syncFromGitHub();
            loadCompletionState();

            // Set initial sync status
            updateSyncStatus(isEditMode ? 'edit' : 'view');

            // Disable checkboxes in view-only mode
            if (!isEditMode) {
                document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                    checkbox.disabled = true;
                    checkbox.style.cursor = 'not-allowed';
                });
            }
        });
    </script>
</body>
</html>
