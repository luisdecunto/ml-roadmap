<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercise Tracker - ML Roadmap</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const ExerciseTracker = () => {
            const [selectedExercise, setSelectedExercise] = useState('linear_algebra');
            const [exerciseContent, setExerciseContent] = useState('');
            const [solutionContent, setSolutionContent] = useState('');
            const [showSolutions, setShowSolutions] = useState(false);
            const [completedExercises, setCompletedExercises] = useState({});

            const exercises = [
                {
                    id: 'linear_algebra',
                    title: 'Linear Algebra',
                    file: 'guides/exercises/linear_algebra_exercises.md',
                    solution: 'guides/solutions/linear_algebra_solutions.md',
                    time: '3-4 hours',
                    difficulty: 'Beginner-Intermediate'
                },
                {
                    id: 'calculus_gradients',
                    title: 'Calculus & Gradients',
                    file: 'guides/exercises/calculus_gradients_exercises.md',
                    solution: 'guides/solutions/calculus_gradients_solutions.md',
                    time: '3-4 hours',
                    difficulty: 'Intermediate'
                }
            ];

            useEffect(() => {
                const saved = localStorage.getItem('completedExercises');
                if (saved) {
                    setCompletedExercises(JSON.parse(saved));
                }
            }, []);

            useEffect(() => {
                localStorage.setItem('completedExercises', JSON.stringify(completedExercises));
            }, [completedExercises]);

            useEffect(() => {
                const exercise = exercises.find(ex => ex.id === selectedExercise);
                if (exercise) {
                    fetch(exercise.file)
                        .then(res => res.text())
                        .then(text => setExerciseContent(marked.parse(text)))
                        .catch(err => setExerciseContent('<p class="text-red-600">Error loading exercises</p>'));

                    fetch(exercise.solution)
                        .then(res => res.text())
                        .then(text => setSolutionContent(marked.parse(text)))
                        .catch(err => setSolutionContent('<p class="text-red-600">Solutions not available yet</p>'));
                }
            }, [selectedExercise]);

            const toggleExercise = (exerciseId, problemId) => {
                const key = `${exerciseId}-${problemId}`;
                setCompletedExercises(prev => ({
                    ...prev,
                    [key]: !prev[key]
                }));
            };

            const getProgress = (exerciseId) => {
                const keys = Object.keys(completedExercises).filter(k => k.startsWith(exerciseId + '-'));
                const completed = keys.filter(k => completedExercises[k]).length;
                return { completed, total: keys.length };
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 p-4 md:p-8">
                    <div className="max-w-6xl mx-auto">
                        {/* Header */}
                        <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                            <div className="flex items-center justify-between mb-4">
                                <div>
                                    <h1 className="text-3xl font-bold text-gray-800">Exercise Tracker</h1>
                                    <p className="text-gray-600">Practice problems with solutions</p>
                                </div>
                                <a
                                    href="index.html"
                                    className="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-semibold"
                                >
                                    ‚Üê Back to Roadmap
                                </a>
                            </div>
                        </div>

                        {/* Exercise Selection */}
                        <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                            <h2 className="text-xl font-bold text-gray-800 mb-4">Select Exercise Set</h2>
                            <div className="grid md:grid-cols-2 gap-4">
                                {exercises.map(exercise => {
                                    const selected = selectedExercise === exercise.id;
                                    const progress = getProgress(exercise.id);
                                    const percentage = progress.total > 0 ? Math.round((progress.completed / progress.total) * 100) : 0;

                                    return (
                                        <button
                                            key={exercise.id}
                                            onClick={() => {
                                                setSelectedExercise(exercise.id);
                                                setShowSolutions(false);
                                            }}
                                            className={`p-4 rounded-lg border-2 transition-all text-left ${
                                                selected
                                                    ? 'border-indigo-600 bg-indigo-50'
                                                    : 'border-gray-200 hover:border-indigo-300'
                                            }`}
                                        >
                                            <h3 className="font-bold text-lg text-gray-800">{exercise.title}</h3>
                                            <div className="flex items-center gap-4 mt-2 text-sm text-gray-600">
                                                <span>‚è±Ô∏è {exercise.time}</span>
                                                <span>üìä {exercise.difficulty}</span>
                                            </div>
                                            {progress.total > 0 && (
                                                <div className="mt-3">
                                                    <div className="flex justify-between text-xs text-gray-600 mb-1">
                                                        <span>Progress</span>
                                                        <span>{progress.completed}/{progress.total} ({percentage}%)</span>
                                                    </div>
                                                    <div className="w-full bg-gray-200 rounded-full h-2">
                                                        <div
                                                            className="bg-indigo-600 h-2 rounded-full transition-all duration-300"
                                                            style={{ width: `${percentage}%` }}
                                                        />
                                                    </div>
                                                </div>
                                            )}
                                        </button>
                                    );
                                })}
                            </div>
                        </div>

                        {/* Content Area */}
                        <div className="bg-white rounded-lg shadow-lg p-6">
                            <div className="flex items-center justify-between mb-6">
                                <div className="flex gap-4">
                                    <button
                                        onClick={() => setShowSolutions(false)}
                                        className={`px-6 py-2 rounded-lg font-semibold transition-colors ${
                                            !showSolutions
                                                ? 'bg-indigo-600 text-white'
                                                : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                        }`}
                                    >
                                        Exercises
                                    </button>
                                    <button
                                        onClick={() => setShowSolutions(true)}
                                        className={`px-6 py-2 rounded-lg font-semibold transition-colors ${
                                            showSolutions
                                                ? 'bg-green-600 text-white'
                                                : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                        }`}
                                    >
                                        Solutions
                                    </button>
                                </div>
                            </div>

                            <div className="prose max-w-none">
                                {!showSolutions ? (
                                    <div dangerouslySetInnerHTML={{ __html: exerciseContent }} />
                                ) : (
                                    <div dangerouslySetInnerHTML={{ __html: solutionContent }} />
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<ExerciseTracker />, document.getElementById('root'));
    </script>
</body>
</html>
